<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Excel æ¸¬è©¦æ–‡ä»¶ç”Ÿæˆå™¨ - é€²éšç‰ˆ</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
            display: flex;
            justify-content: center;
            align-items: center;
        }

        .container {
            background: white;
            border-radius: 20px;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
            max-width: 900px;
            width: 100%;
            padding: 40px;
        }

        h1 {
            color: #333;
            text-align: center;
            margin-bottom: 30px;
            font-size: 2em;
        }

        .section {
            margin-bottom: 30px;
            padding: 20px;
            background: #f8f9fa;
            border-radius: 10px;
        }

        .section h2 {
            color: #667eea;
            margin-bottom: 15px;
            font-size: 1.3em;
        }

        .scenario-list {
            list-style: none;
            padding-left: 0;
        }

        .scenario-list li {
            padding: 8px 0;
            border-bottom: 1px solid #e9ecef;
            line-height: 1.6;
        }

        .scenario-list li:last-child {
            border-bottom: none;
        }

        .highlight {
            background: #fff3cd;
            padding: 15px;
            border-left: 4px solid #ffc107;
            border-radius: 5px;
            margin-top: 15px;
        }

        .stats {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin-top: 20px;
        }

        .stat-card {
            background: white;
            padding: 15px;
            border-radius: 8px;
            text-align: center;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
        }

        .stat-card strong {
            display: block;
            color: #667eea;
            font-size: 1.1em;
            margin-bottom: 5px;
        }

        .buttons {
            display: flex;
            gap: 15px;
            justify-content: center;
            margin-top: 30px;
            flex-wrap: wrap;
        }

        button {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            padding: 15px 30px;
            border-radius: 10px;
            font-size: 1.1em;
            cursor: pointer;
            transition: all 0.3s;
            box-shadow: 0 4px 15px rgba(102, 126, 234, 0.4);
        }

        button:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(102, 126, 234, 0.6);
        }

        button:active {
            transform: translateY(0);
        }

        .download-all {
            background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
            font-size: 1.2em;
            padding: 18px 40px;
        }

        .emoji {
            font-size: 1.2em;
            margin-right: 5px;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1><span class="emoji">ğŸ“Š</span>Excel æ¸¬è©¦æ–‡ä»¶ç”Ÿæˆå™¨ - é€²éšç‰ˆ</h1>
        
        <div class="section">
            <h2>æ¸¬è©¦å ´æ™¯èªªæ˜ï¼š</h2>
            
            <h3><span class="emoji">ğŸ“</span>Sheet1</h3>
            <ul class="scenario-list">
                <li>- å®Œæ•´æ¸¬è©¦å ´æ™¯ (50 è¡Œæ•¸æ“š)ï¼š</li>
                <li><span class="emoji">âœï¸</span> ä¿®æ”¹çš„å„²å­˜æ ¼ (ç¬¬ 5, 10, 15 è¡Œ)</li>
                <li><span class="emoji">ğŸ”´</span> <strong>å€‹åˆ¥åˆªé™¤çš„å„²å­˜æ ¼ (å‰ 10 è¡Œå…§)</strong></li>
                <li><span class="emoji">ğŸŸ¢</span> <strong>å€‹åˆ¥æ–°å¢çš„å„²å­˜æ ¼ (å‰ 10 è¡Œå…§)</strong></li>
                <li><span class="emoji">â•</span> æ–°å¢çš„è¡Œ (File B å¤š 5 è¡Œ)</li>
                <li><span class="emoji">âŒ</span> åˆªé™¤çš„è¡Œ (File A æœ‰ä½† File B æ²’æœ‰çš„ 3 è¡Œ)</li>
                <li><span class="emoji">â•</span> æ–°å¢çš„åˆ— (File B å¤š 2 åˆ—)</li>
                <li><span class="emoji">âŒ</span> åˆªé™¤çš„åˆ— (File A æœ‰ä½† File B æ²’æœ‰çš„ 1 åˆ—)</li>
                <li><span class="emoji">âœ…</span> å¤§é‡æœªè®ŠåŒ–çš„å…§å®¹</li>
            </ul>

            <h3 style="margin-top: 20px;"><span class="emoji">ğŸ“Š</span>DataSheet</h3>
            <ul class="scenario-list">
                <li>- å¤§é‡æ•¸æ“šæ¸¬è©¦ (100 è¡Œ Ã— 15 åˆ—)</li>
                <li><span class="emoji">ğŸ”´</span> <strong>å€‹åˆ¥åˆªé™¤çš„å„²å­˜æ ¼ (å‰ 10 è¡Œå…§)</strong></li>
                <li><span class="emoji">ğŸŸ¢</span> <strong>å€‹åˆ¥æ–°å¢çš„å„²å­˜æ ¼ (å‰ 10 è¡Œå…§)</strong></li>
            </ul>

            <h3 style="margin-top: 20px;"><span class="emoji">â•</span>NewReport</h3>
            <ul class="scenario-list">
                <li>- File B æ–°å¢çš„ sheet</li>
            </ul>

            <h3 style="margin-top: 20px;"><span class="emoji">âŒ</span>OldReport</h3>
            <ul class="scenario-list">
                <li>- File A è¢«åˆªé™¤çš„ sheet</li>
            </ul>

            <h3 style="margin-top: 20px;"><span class="emoji">ğŸ”„</span>Sales â†’ Revenue</h3>
            <ul class="scenario-list">
                <li>- é‡å‘½åæ¸¬è©¦ (95%+ ç›¸ä¼¼åº¦)</li>
            </ul>

            <h3 style="margin-top: 20px;"><span class="emoji">ğŸ”„</span>Q1Data â†’ Q1_2024</h3>
            <ul class="scenario-list">
                <li>- å¦ä¸€å€‹é‡å‘½åæ¸¬è©¦ (88% ç›¸ä¼¼åº¦)</li>
            </ul>

            <h3 style="margin-top: 20px;"><span class="emoji">ğŸ“‹</span>Summary</h3>
            <ul class="scenario-list">
                <li>- å…©å€‹æ–‡ä»¶ç›¸åŒçš„ sheet</li>
            </ul>
        </div>

        <div class="section">
            <h2>æ¸¬è©¦è¦†è“‹ç‡ï¼š</h2>
            <div class="stats">
                <div class="stat-card">
                    <strong>æ–°å¢ï¼š</strong>
                    1 sheet + 5 rows + 2 cols + <span style="color: #28a745;">cells</span>
                </div>
                <div class="stat-card">
                    <strong>åˆªé™¤ï¼š</strong>
                    1 sheet + 3 rows + 1 col + <span style="color: #dc3545;">cells</span>
                </div>
                <div class="stat-card">
                    <strong>ä¿®æ”¹ï¼š</strong>
                    30+ cells
                </div>
                <div class="stat-card">
                    <strong>é‡å‘½åï¼š</strong>
                    2 sheets
                </div>
                <div class="stat-card">
                    <strong>ç¸½æ•¸æ“šé‡ï¼š</strong>
                    200+ rows
                </div>
                <div class="stat-card">
                    <strong>Scroll æ¸¬è©¦ï¼š</strong>
                    <span class="emoji">âœ…</span> å……è¶³
                </div>
            </div>

            <div class="highlight">
                <strong><span class="emoji">ğŸ¯</span> æ–°å¢åŠŸèƒ½ï¼š</strong>
                åœ¨ Sheet1 å’Œ DataSheet çš„å‰ 10 è¡Œä¸­ï¼ŒåŠ å…¥äº†å€‹åˆ¥å„²å­˜æ ¼çš„æ–°å¢å’Œåˆªé™¤æ¸¬è©¦ï¼Œ
                è®“ä½ å¯ä»¥æ¸…æ¥šçœ‹åˆ°ç´…è‰²ï¼ˆåˆªé™¤ï¼‰å’Œç¶ è‰²ï¼ˆæ–°å¢ï¼‰çš„ highlight æ•ˆæœï¼
            </div>
        </div>

        <div class="buttons">
            <button onclick="downloadFileA()">
                <span class="emoji">ğŸ“¥</span> ä¸‹è¼‰ File A (Original)
            </button>
            <button onclick="downloadFileB()">
                <span class="emoji">ğŸ“¥</span> ä¸‹è¼‰ File B (New Version)
            </button>
            <button class="download-all" onclick="downloadBoth()">
                <span class="emoji">âš¡</span> ä¸€éµä¸‹è¼‰å…©å€‹æ–‡ä»¶
            </button>
        </div>
    </div>

    <script>
        // Generate test data for Sheet1
        function generateSheet1Data(isFileB = false) {
            const data = [];
            const headers = ['ID', 'Name', 'Department', 'Salary', 'Status'];
            
            // Add extra columns in File B
            if (isFileB) {
                headers.push('Email', 'Phone');
            } else {
                headers.push('Notes'); // This column will be deleted in File B
            }
            
            data.push(headers);

            // Generate 50 rows
            for (let i = 1; i <= 50; i++) {
                // Skip rows 12, 28, 35 in File B (deleted rows)
                if (isFileB && [12, 28, 35].includes(i)) continue;
                
                const row = [
                    i,
                    `Employee ${i}`,
                    `Dept ${(i % 5) + 1}`,
                    50000 + (i * 1000),
                    'Active'
                ];

                // Modify specific cells
                if (i === 5) {
                    row[3] = isFileB ? 99999 : row[3]; // Modified salary
                }
                if (i === 10) {
                    row[4] = isFileB ? 'Inactive' : 'Active'; // Modified status
                }
                if (i === 15) {
                    row[1] = isFileB ? 'John Smith (Updated)' : `Employee ${i}`; // Modified name
                }

                // **NEW: Individual cell deletions and additions in first 10 rows**
                if (i <= 10) {
                    if (i === 3) {
                        // Row 3: File A has Department, File B leaves it empty (deleted cell)
                        row[2] = isFileB ? '' : row[2];
                    }
                    if (i === 6) {
                        // Row 6: File A has Salary, File B leaves it empty (deleted cell)
                        row[3] = isFileB ? '' : row[3];
                    }
                    if (i === 4) {
                        // Row 4: File B has new Status value, File A leaves it empty (added cell)
                        row[4] = isFileB ? 'Pending' : '';
                    }
                    if (i === 8) {
                        // Row 8: File B has new Department, File A leaves it empty (added cell)
                        row[2] = isFileB ? 'New Dept' : '';
                    }
                }
                
                if (isFileB) {
                    row.push(`emp${i}@company.com`, `555-${1000 + i}`); // New columns
                } else {
                    row.push(`Note for employee ${i}`); // Old column
                }
                
                data.push(row);
            }

            // Add extra rows in File B
            if (isFileB) {
                for (let i = 51; i <= 55; i++) {
                    data.push([
                        i,
                        `New Employee ${i}`,
                        `Dept ${(i % 5) + 1}`,
                        60000,
                        'Active',
                        `emp${i}@company.com`,
                        `555-${1000 + i}`
                    ]);
                }
            }

            return data;
        }

        // Generate test data for DataSheet
        function generateDataSheetData(isFileB = false) {
            const data = [];
            const headers = ['Row', 'Col1', 'Col2', 'Col3', 'Col4', 'Col5', 'Col6', 
                           'Col7', 'Col8', 'Col9', 'Col10', 'Col11', 'Col12', 'Col13', 'Col14'];
            data.push(headers);

            for (let i = 1; i <= 100; i++) {
                const row = [i];
                for (let j = 1; j <= 14; j++) {
                    row.push(`Data_${i}_${j}`);
                }

                // **NEW: Individual cell deletions and additions in first 10 rows**
                if (i <= 10) {
                    if (i === 2) {
                        // Row 2: File A has Col3, File B deletes it
                        row[3] = isFileB ? '' : row[3];
                    }
                    if (i === 5) {
                        // Row 5: File A has Col7, File B deletes it
                        row[7] = isFileB ? '' : row[7];
                    }
                    if (i === 7) {
                        // Row 7: File B adds Col5, File A doesn't have it
                        row[5] = isFileB ? 'NEW_DATA_7_5' : '';
                    }
                    if (i === 9) {
                        // Row 9: File B adds Col10, File A doesn't have it
                        row[10] = isFileB ? 'NEW_DATA_9_10' : '';
                    }
                }
                
                data.push(row);
            }

            return data;
        }

        // Generate renamed sheet data (Sales â†’ Revenue)
        function generateSalesData(isFileB = false) {
            const data = [];
            data.push(['Month', 'Product', 'Sales', 'Profit']);
            
            const months = ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun'];
            const products = ['Product A', 'Product B', 'Product C'];
            
            months.forEach(month => {
                products.forEach(product => {
                    data.push([
                        month,
                        product,
                        Math.floor(Math.random() * 10000),
                        Math.floor(Math.random() * 5000)
                    ]);
                });
            });

            // Add some variations in File B to ensure 95%+ similarity
            if (isFileB) {
                data[5][2] = data[5][2] + 100; // Slightly different value
                data[10][3] = data[10][3] + 50;
            }

            return data;
        }

        // Generate another renamed sheet (Q1Data â†’ Q1_2024)
        function generateQ1Data(isFileB = false) {
            const data = [];
            data.push(['Week', 'Revenue', 'Expenses', 'Net']);
            
            for (let i = 1; i <= 13; i++) {
                const revenue = 10000 + Math.floor(Math.random() * 5000);
                const expenses = 7000 + Math.floor(Math.random() * 3000);
                data.push([
                    `Week ${i}`,
                    revenue,
                    expenses,
                    revenue - expenses
                ]);
            }

            // Add more variations for ~88% similarity
            if (isFileB) {
                data[3][1] = data[3][1] + 500;
                data[7][2] = data[7][2] + 300;
                data[11][3] = data[11][3] + 200;
            }

            return data;
        }

        // Generate unchanged sheet
        function generateSummaryData() {
            const data = [];
            data.push(['Category', 'Count', 'Percentage']);
            data.push(['Active', 45, '90%']);
            data.push(['Inactive', 5, '10%']);
            data.push(['Total', 50, '100%']);
            return data;
        }

        // Generate File A
        function generateFileA() {
            const wb = XLSX.utils.book_new();
            
            // Sheet1
            const sheet1 = XLSX.utils.aoa_to_sheet(generateSheet1Data(false));
            XLSX.utils.book_append_sheet(wb, sheet1, 'Sheet1');
            
            // DataSheet
            const dataSheet = XLSX.utils.aoa_to_sheet(generateDataSheetData(false));
            XLSX.utils.book_append_sheet(wb, dataSheet, 'DataSheet');
            
            // OldReport (will be deleted in File B)
            const oldReport = XLSX.utils.aoa_to_sheet([
                ['This sheet', 'will be', 'deleted'],
                ['in File B', '', '']
            ]);
            XLSX.utils.book_append_sheet(wb, oldReport, 'OldReport');
            
            // Sales (will be renamed to Revenue in File B)
            const sales = XLSX.utils.aoa_to_sheet(generateSalesData(false));
            XLSX.utils.book_append_sheet(wb, sales, 'Sales');
            
            // Q1Data (will be renamed to Q1_2024 in File B)
            const q1Data = XLSX.utils.aoa_to_sheet(generateQ1Data(false));
            XLSX.utils.book_append_sheet(wb, q1Data, 'Q1Data');
            
            // Summary (unchanged)
            const summary = XLSX.utils.aoa_to_sheet(generateSummaryData());
            XLSX.utils.book_append_sheet(wb, summary, 'Summary');
            
            return wb;
        }

        // Generate File B
        function generateFileB() {
            const wb = XLSX.utils.book_new();
            
            // Sheet1 (with modifications)
            const sheet1 = XLSX.utils.aoa_to_sheet(generateSheet1Data(true));
            XLSX.utils.book_append_sheet(wb, sheet1, 'Sheet1');
            
            // DataSheet
            const dataSheet = XLSX.utils.aoa_to_sheet(generateDataSheetData(true));
            XLSX.utils.book_append_sheet(wb, dataSheet, 'DataSheet');
            
            // NewReport (added in File B)
            const newReport = XLSX.utils.aoa_to_sheet([
                ['This is', 'a new', 'sheet'],
                ['added in', 'File B', '!']
            ]);
            XLSX.utils.book_append_sheet(wb, newReport, 'NewReport');
            
            // Revenue (renamed from Sales)
            const revenue = XLSX.utils.aoa_to_sheet(generateSalesData(true));
            XLSX.utils.book_append_sheet(wb, revenue, 'Revenue');
            
            // Q1_2024 (renamed from Q1Data)
            const q1_2024 = XLSX.utils.aoa_to_sheet(generateQ1Data(true));
            XLSX.utils.book_append_sheet(wb, q1_2024, 'Q1_2024');
            
            // Summary (unchanged)
            const summary = XLSX.utils.aoa_to_sheet(generateSummaryData());
            XLSX.utils.book_append_sheet(wb, summary, 'Summary');
            
            return wb;
        }

        // Download functions
        function downloadFileA() {
            const wb = generateFileA();
            XLSX.writeFile(wb, 'Test_File_A_Original.xlsx');
        }

        function downloadFileB() {
            const wb = generateFileB();
            XLSX.writeFile(wb, 'Test_File_B_NewVersion.xlsx');
        }

        function downloadBoth() {
            downloadFileA();
            setTimeout(() => {
                downloadFileB();
            }, 500);
        }
    </script>
</body>
</html>