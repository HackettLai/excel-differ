<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>é‡å‘½åæª¢æ¸¬æ¸¬è©¦ - ä¸åŒå…§å®¹é¡å‹</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            background: white;
            border-radius: 20px;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
            max-width: 1200px;
            width: 100%;
            margin: 0 auto;
            padding: 40px;
        }

        h1 {
            color: #333;
            text-align: center;
            margin-bottom: 30px;
            font-size: 2em;
        }

        .test-section {
            margin-bottom: 30px;
            padding: 20px;
            background: #f8f9fa;
            border-radius: 10px;
        }

        .test-section h2 {
            color: #667eea;
            margin-bottom: 15px;
            font-size: 1.3em;
        }

        .test-card {
            background: white;
            padding: 15px;
            margin-bottom: 15px;
            border-radius: 8px;
            border-left: 4px solid #667eea;
        }

        .test-card h3 {
            color: #333;
            margin-bottom: 10px;
            font-size: 1.1em;
        }

        .test-card ul {
            list-style: none;
            padding-left: 20px;
        }

        .test-card li {
            padding: 5px 0;
            line-height: 1.6;
        }

        .similarity {
            display: inline-block;
            background: #d4edda;
            color: #155724;
            padding: 2px 8px;
            border-radius: 4px;
            font-weight: bold;
            margin-left: 10px;
        }

        .buttons {
            display: flex;
            gap: 15px;
            justify-content: center;
            margin-top: 30px;
            flex-wrap: wrap;
        }

        button {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            padding: 15px 30px;
            border-radius: 10px;
            font-size: 1.1em;
            cursor: pointer;
            transition: all 0.3s;
            box-shadow: 0 4px 15px rgba(102, 126, 234, 0.4);
        }

        button:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(102, 126, 234, 0.6);
        }

        .highlight {
            background: #fff3cd;
            padding: 15px;
            border-left: 4px solid #ffc107;
            border-radius: 5px;
            margin-top: 15px;
        }

        table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 10px;
            font-size: 0.9em;
        }

        th, td {
            padding: 8px;
            text-align: left;
            border-bottom: 1px solid #ddd;
        }

        th {
            background: #667eea;
            color: white;
        }

        .emoji {
            font-size: 1.2em;
            margin-right: 5px;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1><span class="emoji">ğŸ”¬</span>é‡å‘½åæª¢æ¸¬æ¸¬è©¦ - ä¸åŒå…§å®¹é¡å‹</h1>
        
        <div class="test-section">
            <h2>æ¸¬è©¦ç›®çš„ï¼š</h2>
            <p>æ¸¬è©¦ä¸åŒé¡å‹çš„è¡¨æ ¼å…§å®¹æ˜¯å¦æœƒå½±éŸ¿é‡å‘½åæª¢æ¸¬çš„æº–ç¢ºåº¦</p>
        </div>

        <div class="test-section">
            <h2>æ¸¬è©¦æ¡ˆä¾‹ï¼š</h2>

            <div class="test-card">
                <h3>ğŸ”¢ æ¡ˆä¾‹1: æ•¸å­—å¯†é›†å‹æ•¸æ“š</h3>
                <ul>
                    <li>Sheetåç¨±: <strong>Numbers</strong> â†’ <strong>Digits</strong></li>
                    <li>å…§å®¹: 100è¡Œ Ã— 10åˆ—çš„éš¨æ©Ÿæ•¸å­—</li>
                    <li>ä¿®æ”¹: åƒ…2å€‹æ•¸å­—ä¸åŒ <span class="similarity">98% ç›¸ä¼¼åº¦</span></li>
                </ul>
            </div>

            <div class="test-card">
                <h3>ğŸ“ æ¡ˆä¾‹2: æ–‡å­—å¯†é›†å‹æ•¸æ“š</h3>
                <ul>
                    <li>Sheetåç¨±: <strong>TextData</strong> â†’ <strong>StringData</strong></li>
                    <li>å…§å®¹: 50è¡Œæ–‡å­—æè¿°ï¼ˆé•·å­—ä¸²ï¼‰</li>
                    <li>ä¿®æ”¹: åƒ…3å€‹è©ä¸åŒ <span class="similarity">94% ç›¸ä¼¼åº¦</span></li>
                </ul>
            </div>

            <div class="test-card">
                <h3>ğŸ“… æ¡ˆä¾‹3: æ—¥æœŸæ™‚é–“å‹æ•¸æ“š</h3>
                <ul>
                    <li>Sheetåç¨±: <strong>TimeLog</strong> â†’ <strong>DateLog</strong></li>
                    <li>å…§å®¹: 30è¡Œæ—¥æœŸæ™‚é–“è¨˜éŒ„</li>
                    <li>ä¿®æ”¹: åƒ…2å€‹æ—¥æœŸä¸åŒ <span class="similarity">93% ç›¸ä¼¼åº¦</span></li>
                </ul>
            </div>

            <div class="test-card">
                <h3>ğŸ¨ æ¡ˆä¾‹4: æ··åˆå‹æ•¸æ“š</h3>
                <ul>
                    <li>Sheetåç¨±: <strong>MixedData</strong> â†’ <strong>CombinedData</strong></li>
                    <li>å…§å®¹: æ•¸å­—+æ–‡å­—+æ—¥æœŸ+å¸ƒæ—å€¼</li>
                    <li>ä¿®æ”¹: åƒ…4å€‹å€¼ä¸åŒ <span class="similarity">92% ç›¸ä¼¼åº¦</span></li>
                </ul>
            </div>

            <div class="test-card">
                <h3>ğŸ”³ æ¡ˆä¾‹5: ç¨€ç–æ•¸æ“šï¼ˆå¤šç©ºæ ¼ï¼‰</h3>
                <ul>
                    <li>Sheetåç¨±: <strong>SparseData</strong> â†’ <strong>SparseTable</strong></li>
                    <li>å…§å®¹: å¤§é‡ç©ºå„²å­˜æ ¼çš„è¡¨æ ¼</li>
                    <li>ä¿®æ”¹: åƒ…2å€‹éç©ºå€¼ä¸åŒ <span class="similarity">95% ç›¸ä¼¼åº¦</span></li>
                </ul>
            </div>

            <div class="test-card">
                <h3>ğŸ“Š æ¡ˆä¾‹6: å…¬å¼å¯†é›†å‹ï¼ˆç´”å€¼ï¼‰</h3>
                <ul>
                    <li>Sheetåç¨±: <strong>Calculations</strong> â†’ <strong>FormulasResult</strong></li>
                    <li>å…§å®¹: æ¨¡æ“¬å…¬å¼è¨ˆç®—çµæœï¼ˆç´”æ•¸å€¼ï¼‰</li>
                    <li>ä¿®æ”¹: åƒ…3å€‹è¨ˆç®—çµæœä¸åŒ <span class="similarity">91% ç›¸ä¼¼åº¦</span></li>
                </ul>
            </div>

            <div class="test-card">
                <h3>ğŸŒ æ¡ˆä¾‹7: å¤šèªè¨€æ–‡å­—</h3>
                <ul>
                    <li>Sheetåç¨±: <strong>ä¸­æ–‡æ•¸æ“š</strong> â†’ <strong>ä¸­æ–‡è³‡æ–™</strong></li>
                    <li>å…§å®¹: ä¸­æ–‡ã€è‹±æ–‡ã€æ•¸å­—æ··åˆ</li>
                    <li>ä¿®æ”¹: åƒ…2å€‹ä¸­æ–‡è©ä¸åŒ <span class="similarity">96% ç›¸ä¼¼åº¦</span></li>
                </ul>
            </div>

            <div class="test-card">
                <h3>ğŸ“ æ¡ˆä¾‹8: æ¥µå°è¡¨æ ¼</h3>
                <ul>
                    <li>Sheetåç¨±: <strong>TinySheet</strong> â†’ <strong>SmallSheet</strong></li>
                    <li>å…§å®¹: åƒ…5è¡Œ Ã— 3åˆ—</li>
                    <li>ä¿®æ”¹: åƒ…1å€‹å€¼ä¸åŒ <span class="similarity">93% ç›¸ä¼¼åº¦</span></li>
                </ul>
            </div>
        </div>

        <div class="test-section">
            <h2>é æœŸçµæœï¼š</h2>
            <table>
                <thead>
                    <tr>
                        <th>æ¡ˆä¾‹</th>
                        <th>å…§å®¹é¡å‹</th>
                        <th>æ•¸æ“šé‡</th>
                        <th>ç›¸ä¼¼åº¦</th>
                        <th>æ‡‰è©²æª¢æ¸¬ç‚ºé‡å‘½åï¼Ÿ</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>æ¡ˆä¾‹1</td>
                        <td>æ•¸å­—å¯†é›†</td>
                        <td>1000 cells</td>
                        <td>98%</td>
                        <td>âœ… æ˜¯</td>
                    </tr>
                    <tr>
                        <td>æ¡ˆä¾‹2</td>
                        <td>æ–‡å­—å¯†é›†</td>
                        <td>200 cells</td>
                        <td>94%</td>
                        <td>âœ… æ˜¯</td>
                    </tr>
                    <tr>
                        <td>æ¡ˆä¾‹3</td>
                        <td>æ—¥æœŸæ™‚é–“</td>
                        <td>120 cells</td>
                        <td>93%</td>
                        <td>âœ… æ˜¯</td>
                    </tr>
                    <tr>
                        <td>æ¡ˆä¾‹4</td>
                        <td>æ··åˆå‹</td>
                        <td>300 cells</td>
                        <td>92%</td>
                        <td>âœ… æ˜¯</td>
                    </tr>
                    <tr>
                        <td>æ¡ˆä¾‹5</td>
                        <td>ç¨€ç–æ•¸æ“š</td>
                        <td>400 cells (å¤šç©º)</td>
                        <td>95%</td>
                        <td>âœ… æ˜¯</td>
                    </tr>
                    <tr>
                        <td>æ¡ˆä¾‹6</td>
                        <td>å…¬å¼çµæœ</td>
                        <td>200 cells</td>
                        <td>91%</td>
                        <td>âœ… æ˜¯</td>
                    </tr>
                    <tr>
                        <td>æ¡ˆä¾‹7</td>
                        <td>å¤šèªè¨€</td>
                        <td>150 cells</td>
                        <td>96%</td>
                        <td>âœ… æ˜¯</td>
                    </tr>
                    <tr>
                        <td>æ¡ˆä¾‹8</td>
                        <td>æ¥µå°è¡¨æ ¼</td>
                        <td>15 cells</td>
                        <td>93%</td>
                        <td>âœ… æ˜¯</td>
                    </tr>
                </tbody>
            </table>
        </div>

        <div class="highlight">
            <strong><span class="emoji">ğŸ’¡</span> é‡é»ï¼š</strong>
            é€™å€‹æ¸¬è©¦å°‡å¹«åŠ©ä½ äº†è§£ï¼š
            <ul style="margin-top: 10px; padding-left: 20px;">
                <li>âœ… æ•¸å­—ã€æ–‡å­—ã€æ—¥æœŸç­‰ä¸åŒæ•¸æ“šé¡å‹æ˜¯å¦å½±éŸ¿æª¢æ¸¬</li>
                <li>âœ… ç¨€ç–æ•¸æ“šï¼ˆå¤šç©ºæ ¼ï¼‰æ˜¯å¦å½±éŸ¿ç›¸ä¼¼åº¦è¨ˆç®—</li>
                <li>âœ… è¡¨æ ¼å¤§å°ï¼ˆå¾15å€‹cellåˆ°1000å€‹cellï¼‰æ˜¯å¦å½±éŸ¿æª¢æ¸¬</li>
                <li>âœ… å¤šèªè¨€æ–‡å­—æ˜¯å¦å½±éŸ¿æª¢æ¸¬æº–ç¢ºåº¦</li>
            </ul>
        </div>

        <div class="buttons">
            <button onclick="downloadFileA()">
                <span class="emoji">ğŸ“¥</span> ä¸‹è¼‰ File A
            </button>
            <button onclick="downloadFileB()">
                <span class="emoji">ğŸ“¥</span> ä¸‹è¼‰ File B
            </button>
            <button onclick="downloadBoth()" style="background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%); font-size: 1.2em; padding: 18px 40px;">
                <span class="emoji">âš¡</span> ä¸€éµä¸‹è¼‰å…©å€‹æ–‡ä»¶
            </button>
        </div>
    </div>

    <script>
        // æ¡ˆä¾‹1: æ•¸å­—å¯†é›†å‹
        function generateNumbersData(isFileB = false) {
            const data = [['Col1', 'Col2', 'Col3', 'Col4', 'Col5', 'Col6', 'Col7', 'Col8', 'Col9', 'Col10']];
            for (let i = 1; i <= 100; i++) {
                const row = [];
                for (let j = 1; j <= 10; j++) {
                    let value = 1000 + i * 10 + j;
                    // åƒ…ä¿®æ”¹2å€‹å€¼
                    if (isFileB && i === 25 && j === 5) value += 100;
                    if (isFileB && i === 75 && j === 8) value -= 50;
                    row.push(value);
                }
                data.push(row);
            }
            return data;
        }

        // æ¡ˆä¾‹2: æ–‡å­—å¯†é›†å‹
        function generateTextData(isFileB = false) {
            const data = [['Description', 'Category', 'Notes', 'Status']];
            const descriptions = [
                'This is a detailed description of the product features and specifications',
                'Customer feedback indicates high satisfaction with the service quality',
                'The quarterly report shows significant improvement in all key metrics',
                'Implementation of new procedures has streamlined the workflow process',
                'Analysis of market trends reveals emerging opportunities for growth'
            ];
            
            for (let i = 0; i < 50; i++) {
                let desc = descriptions[i % 5];
                let category = `Category ${(i % 10) + 1}`;
                let notes = `Additional notes for item ${i + 1}`;
                let status = 'Active';
                
                // åƒ…ä¿®æ”¹3å€‹è©
                if (isFileB && i === 10) desc = desc.replace('detailed', 'comprehensive');
                if (isFileB && i === 25) category = 'Updated Category';
                if (isFileB && i === 40) notes = notes.replace('Additional', 'Important');
                
                data.push([desc, category, notes, status]);
            }
            return data;
        }

        // æ¡ˆä¾‹3: æ—¥æœŸæ™‚é–“å‹
        function generateDateData(isFileB = false) {
            const data = [['Date', 'Time', 'Timestamp', 'Day']];
            const baseDate = new Date('2024-01-01');
            
            for (let i = 0; i < 30; i++) {
                const date = new Date(baseDate);
                date.setDate(date.getDate() + i);
                
                let dateStr = date.toISOString().split('T')[0];
                let timeStr = `${8 + (i % 12)}:00:00`;
                let timestamp = date.getTime();
                let day = ['Mon', 'Tue', 'Wed', 'Thu', 'Fri', 'Sat', 'Sun'][i % 7];
                
                // åƒ…ä¿®æ”¹2å€‹æ—¥æœŸ
                if (isFileB && i === 10) {
                    dateStr = '2024-01-12';
                }
                if (isFileB && i === 20) {
                    timeStr = '15:30:00';
                }
                
                data.push([dateStr, timeStr, timestamp, day]);
            }
            return data;
        }

        // æ¡ˆä¾‹4: æ··åˆå‹æ•¸æ“š
        function generateMixedData(isFileB = false) {
            const data = [['ID', 'Name', 'Amount', 'Date', 'Active', 'Score']];
            
            for (let i = 1; i <= 50; i++) {
                let id = i;
                let name = `Item ${i}`;
                let amount = 1000 + i * 50;
                let date = `2024-01-${String(i % 28 + 1).padStart(2, '0')}`;
                let active = i % 2 === 0;
                let score = 50 + (i % 50);
                
                // åƒ…ä¿®æ”¹4å€‹å€¼
                if (isFileB && i === 10) name = 'Modified Item 10';
                if (isFileB && i === 20) amount = 9999;
                if (isFileB && i === 30) date = '2024-02-01';
                if (isFileB && i === 40) score = 100;
                
                data.push([id, name, amount, date, active, score]);
            }
            return data;
        }

        // æ¡ˆä¾‹5: ç¨€ç–æ•¸æ“š
        function generateSparseData(isFileB = false) {
            const data = [['A', 'B', 'C', 'D', 'E', 'F', 'G', 'H', 'I', 'J']];
            
            for (let i = 1; i <= 40; i++) {
                const row = new Array(10).fill('');
                // åªæœ‰å°‘æ•¸å„²å­˜æ ¼æœ‰å€¼
                if (i % 4 === 0) row[0] = i;
                if (i % 5 === 0) row[2] = `Value ${i}`;
                if (i % 6 === 0) row[5] = i * 100;
                if (i % 7 === 0) row[8] = 'X';
                
                // åƒ…ä¿®æ”¹2å€‹éç©ºå€¼
                if (isFileB && i === 20) row[2] = 'Changed Value';
                if (isFileB && i === 30) row[5] = 99999;
                
                data.push(row);
            }
            return data;
        }

        // æ¡ˆä¾‹6: å…¬å¼è¨ˆç®—çµæœ
        function generateCalculationsData(isFileB = false) {
            const data = [['Input', 'Double', 'Square', 'Sum', 'Avg']];
            
            for (let i = 1; i <= 40; i++) {
                let input = i;
                let double = i * 2;
                let square = i * i;
                let sum = i + (i * 2) + (i * i);
                let avg = sum / 3;
                
                // åƒ…ä¿®æ”¹3å€‹è¨ˆç®—çµæœ
                if (isFileB && i === 15) double = 999;
                if (isFileB && i === 25) square = 888;
                if (isFileB && i === 35) avg = 777;
                
                data.push([input, double, square, sum, avg.toFixed(2)]);
            }
            return data;
        }

        // æ¡ˆä¾‹7: å¤šèªè¨€æ–‡å­—
        function generateMultiLangData(isFileB = false) {
            const data = [['ä¸­æ–‡', 'English', 'æ•¸å­—', 'æ··åˆ']];
            
            const chineseWords = ['ç”¢å“', 'æœå‹™', 'å“è³ª', 'å®¢æˆ¶', 'éŠ·å”®', 'åˆ©æ½¤', 'å¸‚å ´', 'åˆ†æ', 'å ±å‘Š', 'æ•¸æ“š'];
            const englishWords = ['Product', 'Service', 'Quality', 'Customer', 'Sales', 'Profit', 'Market', 'Analysis', 'Report', 'Data'];
            
            for (let i = 0; i < 30; i++) {
                let chinese = chineseWords[i % 10];
                let english = englishWords[i % 10];
                let number = 1000 + i * 100;
                let mixed = `${chinese}-${english}-${number}`;
                
                // åƒ…ä¿®æ”¹2å€‹ä¸­æ–‡è©
                if (isFileB && i === 10) chinese = 'æ›´æ–°å¾Œçš„ç”¢å“';
                if (isFileB && i === 20) mixed = 'æ–°çš„æ··åˆæ•¸æ“š-Updated-2500';
                
                data.push([chinese, english, number, mixed]);
            }
            return data;
        }

        // æ¡ˆä¾‹8: æ¥µå°è¡¨æ ¼
        function generateTinyData(isFileB = false) {
            const data = [
                ['A', 'B', 'C'],
                [1, 2, 3],
                [4, 5, 6],
                [7, 8, 9],
                [10, 11, 12],
                [13, 14, 15]
            ];
            
            // åƒ…ä¿®æ”¹1å€‹å€¼
            if (isFileB) {
                data[3][1] = 999; // ä¿®æ”¹ç¬¬3è¡Œç¬¬2åˆ—
            }
            
            return data;
        }

        // ç”Ÿæˆ File A
        function generateFileA() {
            const wb = XLSX.utils.book_new();
            
            XLSX.utils.book_append_sheet(wb, XLSX.utils.aoa_to_sheet(generateNumbersData(false)), 'Numbers');
            XLSX.utils.book_append_sheet(wb, XLSX.utils.aoa_to_sheet(generateTextData(false)), 'TextData');
            XLSX.utils.book_append_sheet(wb, XLSX.utils.aoa_to_sheet(generateDateData(false)), 'TimeLog');
            XLSX.utils.book_append_sheet(wb, XLSX.utils.aoa_to_sheet(generateMixedData(false)), 'MixedData');
            XLSX.utils.book_append_sheet(wb, XLSX.utils.aoa_to_sheet(generateSparseData(false)), 'SparseData');
            XLSX.utils.book_append_sheet(wb, XLSX.utils.aoa_to_sheet(generateCalculationsData(false)), 'Calculations');
            XLSX.utils.book_append_sheet(wb, XLSX.utils.aoa_to_sheet(generateMultiLangData(false)), 'ä¸­æ–‡æ•¸æ“š');
            XLSX.utils.book_append_sheet(wb, XLSX.utils.aoa_to_sheet(generateTinyData(false)), 'TinySheet');
            
            return wb;
        }

        // ç”Ÿæˆ File B
        function generateFileB() {
            const wb = XLSX.utils.book_new();
            
            XLSX.utils.book_append_sheet(wb, XLSX.utils.aoa_to_sheet(generateNumbersData(true)), 'Digits');
            XLSX.utils.book_append_sheet(wb, XLSX.utils.aoa_to_sheet(generateTextData(true)), 'StringData');
            XLSX.utils.book_append_sheet(wb, XLSX.utils.aoa_to_sheet(generateDateData(true)), 'DateLog');
            XLSX.utils.book_append_sheet(wb, XLSX.utils.aoa_to_sheet(generateMixedData(true)), 'CombinedData');
            XLSX.utils.book_append_sheet(wb, XLSX.utils.aoa_to_sheet(generateSparseData(true)), 'SparseTable');
            XLSX.utils.book_append_sheet(wb, XLSX.utils.aoa_to_sheet(generateCalculationsData(true)), 'FormulasResult');
            XLSX.utils.book_append_sheet(wb, XLSX.utils.aoa_to_sheet(generateMultiLangData(true)), 'ä¸­æ–‡è³‡æ–™');
            XLSX.utils.book_append_sheet(wb, XLSX.utils.aoa_to_sheet(generateTinyData(true)), 'SmallSheet');
            
            return wb;
        }

        function downloadFileA() {
            const wb = generateFileA();
            XLSX.writeFile(wb, 'Rename_Test_FileA.xlsx');
        }

        function downloadFileB() {
            const wb = generateFileB();
            XLSX.writeFile(wb, 'Rename_Test_FileB.xlsx');
        }

        function downloadBoth() {
            downloadFileA();
            setTimeout(() => {
                downloadFileB();
            }, 500);
        }
    </script>
</body>
</html>